SOURCE_UPLOAD_BUCKET=my-lambda-bucket

# packge, lambda source upload bucket 
aws cloudformation package \
    --template-file cfn_template.yaml \
    --s3-bucket $SOURCE_UPLOAD_BUCKET \
    --output-template-file cfn-packaged-template.yaml

# (first release) deploy lambda
aws cloudformation create-stack \
    --stack-name list-account-lambda \
    --template-body file://./cfn-packaged-template.yaml \
    --capabilities CAPABILITY_NAMED_IAM

# update lambda
aws cloudformation update-stack \
    --stack-name list-account-lambda \
    --template-body file://./cfn-packaged-template.yaml \
    --capabilities CAPABILITY_NAMED_IAM

